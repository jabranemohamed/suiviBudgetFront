<nz-card>
  <h4>Rechercher une Commande</h4>
  <div class="m-t-25">
    <form nz-form [nzLayout]="'inline'" [formGroup]="commandeValidationForm" (ngSubmit)="registerSubmitForm()">

      <nz-form-item>
        <nz-form-label nzRequired>Code UL</nz-form-label>
        <nz-form-control>
          <input formControlName="codeUL" nz-input required placeholder="Code UL"/>
          <nz-form-explain
            *ngIf="commandeValidationForm.get('codeUL').dirty && commandeValidationForm.get('codeUL').errors">Entrer un
            code
            d'unité Local!
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label nzRequired>Année</nz-form-label>
        <nz-form-control>
          <nz-year-picker formControlName="datePicker" nzPlaceHolder="Choisie une année"></nz-year-picker>
          <nz-form-explain
            *ngIf="commandeValidationForm.get('datePicker').dirty && commandeValidationForm.get('datePicker').errors">
            Choisissez une année!
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <button nz-button nzType="primary"><i nz-icon nzType="search"></i>Search</button>

    </form>
  </div>

  <div *ngIf="noDataFoundMessageDisplay" style="text-align: center;">
    <br><br><br>
    <i nz-icon nzType="meh" style="font-size: 20px;color: #c82829"></i>
    <p>Aucun Resultat n'est retrouver !</p>
  </div>

  <br><br><br>
  <div *ngIf="dataFound">
    <nz-table #editCellTable nzBordered [nzScroll]="{ x : '500px' }" [nzPageSize]="50"
              [nzData]="tableEditableCellDataSet">
      <thead>
      <tr>
        <th>ID_dist_cmd</th>
        <th>ID_entet_cmd</th>
        <th>Numero ols</th>
        <th>Fournisseur</th>
        <th>Description commande</th>
        <th>MOE prescripteur</th>
        <th>Budget grande activite</th>
        <th>Budget activite</th>
        <th>Budget notifie</th>
        <th>Bud budgget estime1</th>
        <th>Bud budgget estime2</th>
        <th>Bud budgget estime3</th>
        <th>Bud budgget estime4</th>
        <th>Qte engagee annee en cours</th>
        <th>Reste a receptionner</th>
        <th>Quantité commandée</th>
        <th>quantité réceptionnée</th>
        <th>quantité facturée</th>
        <th>Receptionne_annee_en_cours</th>
        <th>date création commande</th>
        <th>Segment1</th>
        <th>Segment2</th>
        <th>Segment3</th>
        <th>Segment4</th>
        <th>Segment5</th>
        <th>Segment6</th>
        <th>Segment7</th>
        <th>Catgory</th>
        <th>Marche</th>
        <th>Desc_ligne_cmd</th>
        <th>Cmd_a_regulariser</th>
        <th>Cmd_regularisee</th>
        <th>Nouveau_segment7</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let data of editCellTable.data">
        <td>{{data.id_dist_cmd}}</td>
        <td>{{data.id_entet_cmd}}</td>
        <td>{{data.numero_ols}}</td>
        <td>{{data.fournisseur}}</td>
        <td>{{data.description_commande}}</td>
        <td>{{data.moe_prescripteur}}</td>
        <td>
          <nz-select style="width: 120px;" class="m-r-10" [(ngModel)]="data.budget_grande_activite" nzAllowClear
                     nzPlaceHolder="Selectioner"
                     (ngModelChange)="showActivity(data.id_dist_cmd,data.budget_grande_activite)">
            <nz-option *ngFor="let oneGrandBudget of allGrandBudget" nzValue="{{oneGrandBudget}}"
                       nzLabel="{{oneGrandBudget}}"></nz-option>
          </nz-select>
        </td>

        <td>
          <nz-select style="width: 120px;" class="m-r-10" [(ngModel)]="data.budget_activite" nzAllowClear
                     nzPlaceHolder="Selectioner"
                     (ngModelChange)="showBudgetInfos(data.budget_grande_activite,data.budget_activite,data)">
            <nz-option *ngFor="let oneGrandBudget of allBudgets[data.id_dist_cmd]" nzValue="{{oneGrandBudget}}"
                       nzLabel="{{oneGrandBudget}}"></nz-option>
          </nz-select>

        </td>
        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.budget_notifie" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>

        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.bud_budgget_estime1" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>

        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.bud_budgget_estime2" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>

        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.bud_budgget_estime3" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>

        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.bud_budgget_estime4" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>

        <td>{{data.qte_engagee_annee_en_cours}}</td>
        <td>{{data.reste_a_receptionner}}</td>
        <td>{{data.quantite_commandee}}</td>
        <td>{{data.quantite_receptionnee}}</td>
        <td>{{data.quantite_facturee}}</td>
        <td>{{data.recep_avant_annee_en_cours}}</td>
        <td>{{data.date_creation_commande}}</td>
        <td>{{data.segment1}}</td>
        <td>{{data.segment2}}</td>
        <td>{{data.segment3}}</td>
        <td>{{data.segment4}}</td>
        <td>{{data.segment5}}</td>
        <td>{{data.segment6}}</td>
        <td>{{data.segment7}}</td>
        <td>{{data.catgory}}</td>
        <td>{{data.marche}}</td>
        <td>{{data.desc_ligne_cmd}}</td>
        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.cmd_a_regulariser" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>
        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.cmd_regularisee" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>
        <td>
          <div class="editable-cell">
            <div class="editable-cell-text-wrapper">
              <ng-container>
                <input type="text" [(ngModel)]="data.nouveau_segment7" size="5">
                <i nz-icon nzType="check" class="editable-cell-icon-check"></i>
              </ng-container>
            </div>
          </div>
        </td>
      </tr>
      </tbody>
    </nz-table>
  </div>

  <button *ngIf="dataFound" nz-button class="login-form-button" [nzType]="'primary'" (click)="enregistrer()">
    Enregistrer
  </button>
</nz-card>
